<!DOCTYPE html>
<html lang="zh">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å­¦ç”Ÿä¿¡æ¯å¡«å†™</title>
  <link rel="stylesheet" href="/static/change_info.css" />

  <!-- ğŸ” å¼•å…¥å…¨å±€è®¤è¯æ¨¡å— -->
  <script src="/static/AuthManager.js" defer></script>
</head>

<body>

  <div class="form-container">
    <div class="form-header">
      <h2>å­¦ç”Ÿä¿¡æ¯ç™»è®°è¡¨</h2>
      <p>è¯·å‡†ç¡®å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼Œç”¨äºç³»ç»Ÿèº«ä»½è®¤è¯ä¸æœåŠ¡æ¨é€</p>
    </div>
    
    <form id="studentForm">
      <div class="form-grid">

        <!-- æ ¸å¿ƒä¿¡æ¯ï¼ˆå¿…å¡«ï¼‰ -->
        <div class="form-group">
          <label for="stu_id">å­¦å· *</label>
          <input type="text" id="stu_id" name="stu_id" placeholder="è¯·è¾“å…¥å­¦å·" required />
        </div>

        <div class="form-group">
          <label for="name">å§“å *</label>
          <input type="text" id="name" name="name" placeholder="è¯·è¾“å…¥å§“å" required />
        </div>

        <div class="form-group">
          <label for="college">å­¦é™¢ *</label>
          <input type="text" id="college" name="college" list="collegeList" placeholder="è¯·é€‰æ‹©æˆ–è¾“å…¥å­¦é™¢" required />
          <datalist id="collegeList">
            <option value="è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯å­¦é™¢">
            <option value="ç”µå­ä¿¡æ¯å·¥ç¨‹å­¦é™¢">
            <option value="æ•°å­¦ä¸ç»Ÿè®¡å­¦é™¢">
            <option value="å¤–å›½è¯­å­¦é™¢">
            <option value="ç»æµç®¡ç†å­¦é™¢">
            <option value="è‰ºæœ¯è®¾è®¡å­¦é™¢">
          </datalist>
        </div>

        <div class="form-group">
          <label for="major">ä¸“ä¸š</label>
          <input type="text" id="major" name="major" placeholder="è¯·è¾“å…¥ä¸“ä¸š" />
          <!-- ç§»é™¤äº† required -->
        </div>

        <div class="form-group">
          <label for="grade">å¹´çº§</label>
          <select id="grade" name="grade">
            <option value="">ä¸é€‰æ‹©</option>
            <option value="2021">å¤§å››</option>
            <option value="2022">å¤§ä¸‰</option>
            <option value="2023">å¤§äºŒ</option>
            <option value="2024">å¤§ä¸€</option>
          </select>
          <!-- ç§»é™¤äº† required -->
        </div>

        <div class="form-group">
          <label for="class_name">ç­çº§</label>
          <input type="text" id="class_name" name="class_name" placeholder="å¦‚ï¼šè®¡ç§‘2201ç­" />
          <!-- ç§»é™¤äº† required -->
        </div>

        <div class="form-group">
          <label for="gender">æ€§åˆ«</label>
          <select id="gender" name="gender">
            <option value="">æœªé€‰æ‹©</option>
            <option value="ç”·">ç”·</option>
            <option value="å¥³">å¥³</option>
            <option value="å…¶ä»–">å…¶ä»–</option>
          </select>
        </div>

        <!-- è”ç³»æ–¹å¼å…¨éƒ¨æ”¹ä¸ºéå¿…å¡« -->
        <div class="form-group">
          <label for="phone">è”ç³»ç”µè¯</label>
          <input type="tel" id="phone" name="phone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç " pattern="[0-9]{11}" />
        </div>

        <div class="form-group">
          <label for="email">ç”µå­é‚®ç®±</label>
          <input type="email" id="email" name="email" placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€" />
        </div>

        <div class="form-group">
          <label for="qq">QQ å·ç ï¼ˆå¯é€‰ï¼‰</label>
          <input type="text" id="qq" name="qq" placeholder="è¯·è¾“å…¥ QQ å·" />
        </div>

        <div class="form-group full-width">
          <label for="note">å¤‡æ³¨</label>
          <input type="text" id="note" name="note" placeholder="å¦‚æœ‰ç‰¹æ®Šè¯´æ˜ï¼Œè¯·å¡«å†™" />
        </div>

      </div>

      <button type="submit" class="submit-btn">æäº¤ä¿¡æ¯</button>
    </form>
  </div>

  <script>
    document.getElementById("studentForm").addEventListener("submit", async function (e) {
      e.preventDefault();
      const formData = new FormData(this);
      const data = Object.fromEntries(formData.entries());

      const response = await AuthManager.request("/user/commit", {
        method: "POST",
        body: JSON.stringify(data)
      });
      const result = await response.json();
      if (result.success) {
        alert("ä¿¡æ¯æ›´æ–°å®Œæˆï¼Œå’Œä½ çš„AIä¼´ä¾£å…±èµ´æœªæ¥å§")
        window.location.href = "/";
      }
      else {
        alert(result.message)
      }
    });
  </script>

</body>

</html>